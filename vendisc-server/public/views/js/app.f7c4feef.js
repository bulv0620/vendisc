(function(){var e={7730:function(){},3459:function(){},586:function(e,t,o){"use strict";o.d(t,{IJ:function(){return I},Wf:function(){return h},Vm:function(){return v},xT:function(){return y},G:function(){return x},TX:function(){return _},Qx:function(){return C},F$:function(){return b},$w:function(){return k},sC:function(){return f},dW:function(){return g},bV:function(){return p},wg:function(){return m},eN:function(){return w}});o(7658);var n=o(70),r=o(530),i=o.n(r),a=o(7232),s=o(2709),l=o(1008);const c=l.L+"/api",d=n.ZP.create({timeout:1e4,baseURL:c,method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"}});d.interceptors.request.use((e=>{const t=a.Z.state.user.token,o=a.Z.getters.curLid;return i().start(),e.headers.Authorization=t,e.headers.lid=o,e})),d.interceptors.response.use((e=>{i().done();const t=e.data;return t.code>0?t:(-25===t.code&&(localStorage.removeItem("USER_TOKEN"),a.Z.dispatch("userLogout",!1),s.Z.push("/login")),Promise.reject(e.data.msg))}),(e=>(i().done(),Promise.reject(e))));var u=d;const p=e=>u.post("/user/login",e),f=e=>u.get(`/user/retrieve/${e}`),m=()=>u.get("/user/logout"),h=e=>u.post("/user/password",e),g=()=>u.get("/user/info"),v=()=>u.get("/list"),y=()=>u.get("/file/used"),w=e=>u.post("/user/register",e),b=e=>u.post("/file/rename",e),k=e=>u.post("/folder/rename",e),I=e=>u.post("/folder/create",{fdname:e}),_=e=>u.get(`/file/remove/${e}`),C=e=>u.get(`/folder/remove/${e}`),x=(e,t)=>u.post("/file/move",{fid:e,fdid:t})},1008:function(e,t,o){"use strict";o.d(t,{L:function(){return n}});const n=""},5518:function(e,t,o){"use strict";var n=o(6369),r=function(){var e=this,t=e._self._c;return t("GlobalLayout")},i=[],a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"container"},[t("transition",{attrs:{name:"view",mode:"out-in"}},[t("router-view")],1)],1)])},s=[],l=o(3459),c=o.n(l),d=c(),u=o(1001),p=(0,u.Z)(d,a,s,!1,null,"67129737",null),f=p.exports,m={components:{GlobalLayout:f}},h=m,g=(0,u.Z)(h,r,i,!1,null,null,null),v=g.exports,y=o(2709),w=o(7232),b=o(8833),k=o.n(b),I=o(5428),_=o.n(I),C=(o(7144),function(){var e=this,t=e._self._c;return t("div",{staticClass:"content",style:{width:e.bSize+"px",height:e.bSize+"px",borderColor:e.waveColor}},[t("canvas",{attrs:{id:"canvas"}}),t("p",{staticClass:"value",style:{fontSize:e.fontSize,color:e.fontColor}},[e._v(e._s((100*e.rate).toFixed(0))+"%")])])}),x=[],F=(o(7658),{data(){return{}},props:{rate:{type:Number,default:.6},bSize:{type:Number,default:100},waveColor:{type:String,default:"#D8BFD8"},fontColor:{type:String,default:"#8B008B"},speed:{type:Number,default:3},flat:{type:Number,default:400},distance:{type:Number,default:150},wave:{type:Number,default:10},opacity:{type:Number,default:.5},fontSize:{type:String,default:"1rem"}},methods:{drawSin(e,t,o,n,r,i){e.save(),e.beginPath(),e.moveTo(0,t),e.lineTo(0,i),e.quadraticCurveTo(t/4,i-r,t/2,i),e.lineTo(t/2,i),e.quadraticCurveTo(3*t/4,i+r,t,i),e.lineTo(t,t),e.lineTo(0,t),e.fillStyle=o,e.fill(),e.restore()},init(){let e=document.getElementById("canvas"),t=e.clientWidth;e.style.height=t,e.width=e.height=t;let o=document.createElement("canvas"),n=o.getContext("2d");o.width=t,o.height=t;let r=document.createElement("canvas"),i=r.getContext("2d");r.width=t,r.height=t;let{flat:a,speed:s,rate:l,distance:c,wave:d,waveColor:u,opacity:p}=this,f=0,m=e.getContext("2d");this.drawSin(n,t,u,u,d,t-t*l),this.drawSin(i,t,`${this.sixteenToRgba(u,p)}`,null,d,t-t*l);let h=l,g=d;function v(){l===h&&g===d||(n.clearRect(0,0,t,t),i.clearRect(0,0,t,t),h=l,g=d,this?.drawSin(n,t,u,u,d,t-t*l),this?.drawSin(i,t,`${this.sixteenToRgba(u,p)}`,null,d,t-t*l)),m.clearRect(0,0,t,t),m.drawImage(o,f,0,t+a,t),m.drawImage(o,f-t-a,0,t+a,t),m.drawImage(r,f+c,0,t+a,t),m.drawImage(r,f-t+c-a,0,t+a,t),f>=t-s+a?f=0:f+=s,requestAnimationFrame(v)}v()},sixteenToRgba(e,t){let o=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,n=e;if(n&&o.test(n)){if(4===n.length){let e="#";for(let t=1;t<4;t+=1)e+=n.slice(t,t+1).concat(n.slice(t,t+1));n=e}let e=[];for(let t=1;t<7;t+=2)e.push(parseInt("0x"+n.slice(t,t+2)));return"rgba("+e.join(",")+`,${t})`}return n}},mounted(){this.init()},watch:{rate(){this.init()}}}),$=F,S=(0,u.Z)($,C,x,!1,null,"375d128c",null),D=S.exports,L=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("span",{staticClass:"divider"},[e._v("|")])},T=[],E=o(7730),R=o.n(E),B=R(),O=(0,u.Z)(B,L,T,!1,null,"1a8c17c4",null),U=O.exports,N=function(){var e=this,t=e._self._c;return t("vs-alert",{staticClass:"mb",attrs:{danger:"",progress:e.progress},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v(" "+e._s(e.msg)+" ")])},P=[],M={props:["display","msg"],data:()=>({show:!1,time:3e3,progress:0}),watch:{display(e){if(e){this.show=!0;let e=setInterval((()=>{this.progress++}),this.time/100);setTimeout((()=>{this.show=!1,this.$emit("update:display",!1),clearInterval(e),this.progress=0}),this.time)}}}},Z=M,z=(0,u.Z)(Z,N,P,!1,null,"d9705836",null),j=z.exports,A=function(){var e=this,t=e._self._c;return t("vs-input",e._b({attrs:{block:"",state:e.state},on:{input:e.clearState},scopedSlots:e._u([{key:"icon",fn:function(){return[t("box-icon",{attrs:{name:e.icon,type:"solid",color:"#999"}})]},proxy:!0},e.error&&""!==e.msg?{key:"message-danger",fn:function(){return[t("p",[e._v(e._s(e.msg))])]},proxy:!0}:null],null,!0),model:{value:e.modelValue,callback:function(t){e.modelValue=t},expression:"modelValue"}},"vs-input",e.$attrs,!1))},q=[],V={props:["value","icon","error","msg"],data:()=>({modelValue:""}),computed:{state(){return this.error?"danger":""}},watch:{value(e){this.modelValue=e},modelValue(e){this.$emit("update:value",e)}},methods:{clearState(){this.$emit("update:error",!1)}},mounted(){this.modelValue=this.value}},G=V,X=(0,u.Z)(G,A,q,!1,null,"b064c3f4",null),H=X.exports,K=function(){var e=this,t=e._self._c;return t("vs-dialog",{attrs:{width:"300px","not-center":"",loading:e.loading},scopedSlots:e._u([{key:"header",fn:function(){return[t("h4",{staticClass:"not-margin"},[e._v(" "+e._s(e.title)+" ")])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"con-footer"},[t("vs-button",{attrs:{transparent:""},on:{click:function(t){return e.$emit("handleOk")}}},[e._v(" Ok ")]),t("vs-button",{attrs:{dark:"",transparent:""},on:{click:function(t){e.active=!1}}},[e._v(" Cancel ")])],1)]},proxy:!0}]),model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[t("div",{staticClass:"con-content"},[e._t("default")],2)])},W=[],J={props:{show:Boolean,title:String,loading:Boolean},data:()=>({active:!1}),mounted(){this.active=this.show},watch:{active(e){this.$emit("update:show",e)},show(e){this.active=e}}},Q=J,Y=(0,u.Z)(Q,K,W,!1,null,null,null),ee=Y.exports,te=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapper"},[t("header",[e._v("File Uploader")]),t("form",{ref:"form",attrs:{action:"#"},on:{click:e.handleFormClick}},[t("input",{ref:"fileInput",staticClass:"file-input",attrs:{type:"file",name:"file",hidden:""},on:{change:e.handleInputChange}}),t("box-icon",{attrs:{type:"solid",name:"cloud-upload",size:"lg",color:"#6990F2"}}),t("p",[e._v("Browse File to Upload")])],1),t("div",{staticClass:"status"},[t("section",{staticClass:"progress-area",class:e.uploadedAreaClass},e._l(e.uploadingList,(function(o,n){return t("li",{directives:[{name:"show",rawName:"v-show",value:!o.finished,expression:"!item.finished"}],key:n,staticClass:"row"},[t("box-icon",{attrs:{name:"file",type:"solid",color:"#6990F2",size:"md"}}),t("div",{staticClass:"content"},[t("div",{staticClass:"details"},[t("span",{staticClass:"name"},[e._v(e._s(o.uploadingName)+" • Uploading")]),t("span",{staticClass:"percent"},[e._v(e._s(o.uploadingRatio)+"%")])]),t("div",{staticClass:"progress-bar"},[t("div",{staticClass:"progress",style:{width:o.uploadingRatio+"%"}})])])],1)})),0),t("section",{staticClass:"uploaded-area"},e._l(e.uploadedList,(function(o,n){return t("li",{key:n,staticClass:"row"},[t("div",{staticClass:"content uploaded"},[t("box-icon",{attrs:{name:"file",type:"solid",color:"#6990F2",size:"md"}}),t("div",{staticClass:"details"},[t("span",{staticClass:"name"},[e._v(e._s(o.name)+" • Uploaded")]),t("span",{staticClass:"size"},[e._v(e._s(o.fileSize))])])],1),t("box-icon",{attrs:{name:"check-square",color:"#6990F2"}})],1)})),0)])])},oe=[],ne=(o(541),o(1399)),re=o(1008),ie={data:()=>({uploadedAreaClass:"",progressHtml:"",uploadingList:[],uploadedList:[]}),methods:{abortAllTask(){this.uploadingList.forEach((e=>{e.finished||e.xhr.abort()}))},handleFormClick(){this.$refs.fileInput.click()},handleInputChange({target:e}){let t=e.files[0];if(t){let e=t.name;if(e.length>=50)return void this.$vs.notification({icon:"<box-icon name='error-circle' color='white'></box-icon>",duration:4e3,progress:"auto",color:"danger",position:"top-center",title:"Error",text:"File name must be between 1-50"});if(e.length>=13){let t=e.split(".");e=t[0].substring(0,13)+"... ."+t[1]}this.uploadFile(e)}},uploadFile(e){let t=new XMLHttpRequest;const o={uploadingName:e,uploadingRatio:0,finished:!1,fileSize:null,xhr:t};let n=null;this.uploadingList.unshift(o),t.open("POST",`${re.L}/api/file/upload`),t.setRequestHeader("Authorization",this.$store.state.user.token),t.setRequestHeader("lid",this.$store.getters.curLid),t.upload.addEventListener("progress",(({loaded:t,total:r})=>{let i=Math.floor(t/r*100);if(o.uploadingRatio=i,this.uploadedAreaClass="onprogress",t==r){let t=Math.floor(r/1e3);o.finished=!0,n={name:e,fileSize:(0,ne.M)(1024*t)},this.uploadedList.unshift(n)}})),t.addEventListener("readystatechange",(()=>{if(4===t.readyState&&t.response){const e=JSON.parse(t.response);e.code<=0&&(this.uploadedList.splice(this.uploadedList.indexOf(n),1),this.$vs.notification({icon:"<box-icon name='error-circle' color='white'></box-icon>",duration:4e3,progress:"auto",color:"danger",position:"top-center",title:"Error",text:e.msg}))}}));let r=new FormData(this.$refs.form);t.send(r)}}},ae=ie,se=(0,u.Z)(ae,te,oe,!1,null,"75e0337c",null),le=se.exports,ce=function(){var e=this,t=e._self._c;return t("div",{staticClass:"progress-box",style:{height:e.height}},[t("div",{staticClass:"progress",style:{background:e.color,width:e.ratio+"%"}})])},de=[],ue={props:{height:{type:String,required:!1,default:"8px"},color:{type:String,required:!1,default:"#6990F2"},ratio:{type:Number,required:!1,default:0}}},pe=ue,fe=(0,u.Z)(pe,ce,de,!1,null,"7caadabc",null),me=fe.exports;n["default"].config.productionTip=!1,n["default"].component("WaveBall",D),n["default"].component("ColDivider",U),n["default"].component("ErrorAlert",j),n["default"].component("MyInput",H),n["default"].component("MyDialog",ee),n["default"].component("MyProgress",me),n["default"].component("FileUploader",le),n["default"].use(k(),{}),n["default"].use(_()),new n["default"]({router:y.Z,store:w.Z,render:e=>e(v)}).$mount("#app")},2709:function(e,t,o){"use strict";o.d(t,{Z:function(){return J}});var n=o(6369),r=o(2631),i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"home-view"}},[t("TopBar",{on:{refresh:e.loadData}}),t("FileTable",{attrs:{list:e.files,selectedItem:e.selectedItem},on:{"update:selectedItem":function(t){e.selectedItem=t},"update:selected-item":function(t){e.selectedItem=t},refresh:e.loadData,openFolder:e.openFolder,handleCopyUrl:e.copyUrl}}),t("SmartBar",{attrs:{selectedType:e.selectedType,downloading:e.downloading,downloadFilename:e.downloadFilename,downloadRatio:e.downloadRatio},on:{clear:e.clearSelected,refresh:e.loadData,openFolder:e.openFolder,handleDelete:function(t){e.removeDialog=!0},handleRename:function(t){e.renameDialog=!0,e.renameInput=e.selectedItem.name},handleCreateFolder:function(t){e.folderDialog=!0,e.folderInput=""},handleCopyUrl:e.copyUrl,handleDownload:e.download,handleUploadFile:function(t){e.uploadDialog=!0},abortTask:e.abortDownload}}),t("MyDialog",{attrs:{show:e.folderDialog,title:"Input new name",loading:e.createFolderLoading},on:{"update:show":function(t){e.folderDialog=t},handleOk:e.createFolder}},[t("MyInput",{attrs:{value:e.folderInput,icon:"bowling-ball",error:e.folderInputError,msg:e.folderInputErrorMsg,placeholder:"Input New Folder Name"},on:{"update:value":function(t){e.folderInput=t}}})],1),t("MyDialog",{attrs:{show:e.renameDialog,title:"Input new name",loading:e.renameLoading},on:{"update:show":function(t){e.renameDialog=t},handleOk:e.handleRename}},[t("MyInput",{attrs:{value:e.renameInput,icon:"bowling-ball",error:e.renameInputError,msg:e.renameInputErrorMsg,placeholder:"Input New Name"},on:{"update:value":function(t){e.renameInput=t}}})],1),t("MyDialog",{attrs:{show:e.removeDialog,title:"Confirm"},on:{"update:show":function(t){e.removeDialog=t},handleOk:e.removeItem}},[t("p",[e._v(" The operation is irreversible, whether to execute? ")])]),t("UploadDialog",{attrs:{show:e.uploadDialog},on:{"update:show":function(t){e.uploadDialog=t}}})],1)},a=[],s=o(3822),l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table"},[t("vs-table",{scopedSlots:e._u([{key:"thead",fn:function(){return[t("vs-tr",{attrs:{color:"youtube"}},[t("vs-th",[e._v(" Name ")]),t("vs-th",[e._v(" Size ")]),t("vs-th",[e._v(" Time ")])],1)]},proxy:!0},{key:"tbody",fn:function(){return e._l(e.list,(function(o,n){return t("vs-tr",{key:n,attrs:{data:o,"is-selected":e.selected==o},nativeOn:{dblclick:function(t){return e.open(o)},dragover:function(t){return e.handleDragover(t,o.type)},drop:function(t){return e.handleDrop(o.fdid)}}},[t("vs-td",{staticStyle:{position:"relative"},attrs:{draggable:"folder"!==o.type},nativeOn:{dragstart:function(t){return e.handleDragstart(o.fid)}}},[t("box-icon",{staticStyle:{position:"absolute",top:"50%",transform:"translateY(-50%)"},attrs:{type:"solid",name:e.getFileTypeIcon(o.type),color:"grey",size:"1.3rem"}}),t("span",{staticClass:"table-span"},[e._v(e._s(o.name))])],1),t("vs-td",[e._v(" "+e._s(e.calculateSize(o.size))+" ")]),t("vs-td",[e._v(" "+e._s(o.timestamp)+" ")])],1)}))},proxy:!0}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},c=[],d=o(1399),u={props:["list","selectedItem"],data:()=>({selected:null}),watch:{selected(e){this.emitUpdateSelected(e)},selectedItem(e){this.selected=e}},methods:{calculateSize:d.M,async handleDrop(e){console.log("drop:"+e),this.$store.commit("setDropFolderId",e),await this.$store.dispatch("moveFile"),this.$emit("refresh")},handleDragover(e,t){"folder"===t&&e.preventDefault()},handleDragstart(e){console.log("start:"+e),this.$store.commit("setDragFildId",e)},open(e){"folder"===e.type?this.$emit("openFolder",e):this.$emit("handleCopyUrl")},emitUpdateSelected(e){this.$emit("update:selectedItem",e)},getFileTypeIcon(e){switch(e){case"folder":return"folder";case"image":return"file-image";case"txt":return"file-txt";case"word":return"file-doc";case"pdf":return"file-pdf";case"zip":return"file-archive";case"video":return"videos";case"radio":return"music";default:return"file-blank"}}}},p=u,f=o(1001),m=(0,f.Z)(p,l,c,!1,null,"c9e838a8",null),h=m.exports,g=(o(7658),function(){var e=this,t=e._self._c;return t("div",{staticClass:"smart-bar"},[t("div",{key:"btn-container",staticClass:"btn-container"},[t("transition-group",{attrs:{name:"fade"}},[t("BarButton",{key:"user",attrs:{color:"skype",type:"solid",icon:"user",tip:"View personal page"},nativeOn:{click:function(t){return e.$router.push("/user")}}}),e.isRoot?e._e():t("BarButton",{key:"home",attrs:{color:"reddit",type:"solid",icon:"home",tip:"Back to homepage"},nativeOn:{click:function(t){return e.$store.commit("backRoot")}}}),e.isRoot?e._e():t("BarButton",{key:"back",attrs:{color:"discord",type:"solid",icon:"chevron-left-circle",tip:"Back to previous page"},nativeOn:{click:function(t){return e.$store.dispatch("backToPervPage")}}}),t("ColDivider",{key:"divider1"}),t("BarButton",{key:"upload",attrs:{color:"defalut",type:"solid",icon:"cloud-upload",tip:"Upload file"},nativeOn:{click:function(t){return e.$emit("handleUploadFile")}}}),t("BarButton",{key:"folder",attrs:{color:"amazon",type:"solid",icon:"folder-plus",tip:"Create folder"},nativeOn:{click:function(t){return e.$emit("handleCreateFolder")}}}),t("BarButton",{key:"refresh",attrs:{color:"google-plus",icon:"refresh",tip:"Refresh"},nativeOn:{click:function(t){return e.$emit("refresh")}}}),e.selectedType?[t("ColDivider",{key:"divider2"}),"folder"!==e.selectedType?[t("BarButton",{key:"download",attrs:{color:"medium",type:"solid",icon:"cloud-download",tip:"Download file"},nativeOn:{click:function(t){return e.$emit("handleDownload")}}}),t("BarButton",{key:"copy",attrs:{color:"messenger",type:"solid",icon:"copy",tip:"Copy file url"},nativeOn:{click:function(t){return e.$emit("handleCopyUrl")}}})]:e._e(),"folder"===e.selectedType?t("BarButton",{key:"open",attrs:{color:"messenger",type:"solid",icon:"folder-open",tip:"Open folder"},nativeOn:{click:function(t){return e.$emit("openFolder")}}}):e._e(),t("BarButton",{key:"rename",attrs:{color:"dribbble",type:"solid",icon:"rename",tip:"Rename item"},nativeOn:{click:function(t){return e.$emit("handleRename")}}}),t("BarButton",{key:"delete",attrs:{color:"youtube",type:"solid",icon:"trash",tip:"Delete item"},nativeOn:{click:function(t){return e.$emit("handleDelete")}}}),t("vs-button",{key:"close",attrs:{circle:"",icon:"",transparent:""},on:{click:function(t){return e.$emit("clear")}}},[t("box-icon",{attrs:{name:"chevron-left",color:"#ccc"}})],1)]:e._e()],2)],1),t("transition",{attrs:{name:"change"}},[e.downloading?t("div",{key:"downlaod-box",staticClass:"download-box"},[t("div",{staticClass:"close-btn",on:{click:e.abortTask}},[t("box-icon",{attrs:{name:"x",color:"#999"}})],1),t("div",{staticClass:"download-container"},[t("vs-tooltip",{scopedSlots:e._u([{key:"tooltip",fn:function(){return[e._v(" "+e._s(e.downloadFilename)+" ")]},proxy:!0}],null,!1,917957136)},[t("span",[e._v(e._s(`${e.shortCutString(e.downloadFilename)} - ${e.downloadRatio}%`))])]),t("div",{staticClass:"progress-container"},[t("MyProgress",{attrs:{ratio:e.downloadRatio}})],1)],1)]):e._e()])],1)}),v=[],y=function(){var e=this,t=e._self._c;return t("vs-button",{attrs:{circle:"",icon:"",color:e.color}},[t("box-icon",{attrs:{type:e.type,name:e.icon,color:"white"}})],1)},w=[],b={props:{color:{type:String,required:!0},icon:{type:String,requried:!0},tip:{type:String,required:!0},type:{type:String,default:""}}},k=b,I=(0,f.Z)(k,y,w,!1,null,"5da72be8",null),_=I.exports,C={props:["selectedType","backActive","downloading","downloadRatio","downloadFilename"],components:{BarButton:_},computed:{...(0,s.Se)(["isRoot"])},methods:{shortCutString(e){if(e.length>=8){let t=e.split(".");return t[0].substring(0,4)+"... ."+(t[1]||"")}return e},abortTask(){this.$emit("abortTask")}}},x=C,F=(0,f.Z)(x,g,v,!1,null,"58d66e74",null),$=F.exports,S=function(){var e=this,t=e._self._c;return t("div",{staticClass:"top-bar"},[t("vs-button",{attrs:{disabled:""}},[t("box-icon",{attrs:{name:"menu",color:"white"}})],1),t("div",{staticClass:"breadcrumb"},[t("ul",e._l(e.list,(function(o,n){return t("li",{key:n},[t("a",{attrs:{href:"#"},on:{click:function(t){return e.changeLocation(n)},drop:function(t){return e.handleDrop(o.lid)},dragover:e.handleDragover}},[e._v(e._s(o.name))]),n!==e.list.length-1?t("span",{staticStyle:{color:"#ccc"}},[e._v(">")]):e._e()])})),0)]),t("WaveBall",{staticClass:"wave-ball",attrs:{rate:Number(e.$store.getters.capacityRatio),bSize:40,fontSize:".9rem",waveColor:"#71eabe",fontColor:"#02B875"}})],1)},D=[],L={computed:{...(0,s.rn)({list:e=>e.location.list}),...(0,s.Se)(["isRoot","currentLocation"])},methods:{changeLocation(e){this.$store.commit("changeLocation",e)},async handleDrop(e){console.log("drop:"+e),this.$store.commit("setDropFolderId",e),await this.$store.dispatch("moveFile"),this.$emit("refresh")},handleDragover(e){e.preventDefault()}},watch:{currentLocation(){this.$emit("refresh")}}},T=L,E=(0,f.Z)(T,S,D,!1,null,"fcb37afc",null),R=E.exports,B=function(){var e=this,t=e._self._c;return t("vs-dialog",{attrs:{blur:""},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[t("FileUploader",{ref:"fileUploader"})],1)},O=[],U={props:["show"],data:()=>({active:!1}),watch:{active(e){this.$emit("update:show",e),e||this.$refs.fileUploader.abortAllTask()},show(e){this.active=e}},mounted(){this.active=this.show}},N=U,P=(0,f.Z)(N,B,O,!1,null,"4a8141b7",null),M=P.exports,Z=o(586),z=o(4847),j=o(1008),A={components:{FileTable:h,SmartBar:$,TopBar:R,UploadDialog:M},computed:{selectedType(){return this.selectedItem?this.selectedItem.type:null},...(0,s.rn)({files:e=>e.file.list})},data:()=>({selectedItem:null,loading:null,folderDialog:!1,renameDialog:!1,removeDialog:!1,uploadDialog:!1,removeLoading:!1,renameInput:"",renameInputError:!1,renameInputErrorMsg:"",renameLoading:!1,folderInput:"",folderInputError:!1,folderInputErrorMsg:"",createFolderLoading:!1,downloadRatio:0,downloading:!1,downloadFilename:"",downloadTaskXhr:null,audio:null}),async created(){try{await this.loadUserInfo(),await this.$store.dispatch("getUsedCapacity"),await this.loadData(),this.audio=new Audio,this.audio.src=`${j.L}/sound/download_finish.mp3`}catch(e){console.error(e)}},methods:{openFolder(e){e||(e=this.selectedItem),this.$store.commit("setLocation",{lid:e.fdid,name:e.name}),this.clearSelected()},clearSelected(){this.selectedItem=null},download(){if(this.downloading)return void this.errorNotification("The current task is not completed");const e=this.selectedItem.url,t=this.selectedItem.name;this.downloading=!0,this.downloadFilename=t;let o=new XMLHttpRequest;this.downloadTaskXhr=o,o.open("GET",e,!0),o.responseType="blob",o.onload=function(){let e=window.URL.createObjectURL(o.response),n=document.createElement("a");n.href=e,n.download=t,n.click()},o.addEventListener("progress",(({loaded:e,total:t})=>{this.downloadRatio=Math.floor(e/t*100),e==t&&(this.downloading=!1,this.downloadRatio=0,this.audio.play(),this.successNotification("File download complete"),this.downloadTaskXhr=null)})),o.send()},abortDownload(){this.downloading=!1,this.downloadRatio=0,this.downloadTaskXhr.abort(),this.downloadTaskXhr=null},copyUrl(){const e=this.selectedItem.url;this.$copyText(e).then((()=>{console.log("copy right:"+e),this.successNotification("The link has been copied to the clipboard")}),(()=>{console.error("copy error")}))},async loadData(){this.loading=this.$vs.loading();try{this.clearSelected()}catch(e){this.$store.commit("cancelChange"),console.error(e)}finally{await this.$store.dispatch("getList"),this.loading.close()}},async loadUserInfo(){await this.$store.dispatch("getUserInfo"),this.$store.commit("setRootLid",this.$store.state.user.info.root_id)},async handleRename(){const{type:e}=this.selectedItem;"folder"===e?this.rename(Z.$w,{fdid:this.selectedItem.fdid,fdname:this.renameInput}):this.rename(Z.F$,{fid:this.selectedItem.fid,fname:this.renameInput})},async rename(e,t){this.renameLoading=!0;try{if(!(0,z.Gu)(z.qg,this,this.renameInput,"renameInput"))throw"Invalid input";await e(t),this.renameDialog=!1,this.loadData()}catch(o){console.error(o),this.errorNotification(o)}finally{this.renameLoading=!1}},async removeItem(){const{type:e}=this.selectedItem;"folder"===e?this.remove(Z.Qx,this.selectedItem.fdid):this.remove(Z.TX,this.selectedItem.fid)},async remove(e,t){this.removeLoading=!0;try{await e(t),this.loadData(),this.$store.dispatch("getUsedCapacity")}catch(o){console.error(o),this.errorNotification(o)}finally{this.removeDialog=!1,this.removeLoading=!1}},async createFolder(){this.createFolderLoading=!0;try{if(!(0,z.Gu)(z.qg,this,this.folderInput,"folderInput"))throw"Invalid input";await(0,Z.IJ)(this.folderInput),this.folderDialog=!1,this.loadData()}catch(e){console.error(e),this.errorNotification(e)}finally{this.createFolderLoading=!1}},errorNotification(e){this.$vs.notification({icon:"<box-icon name='error-circle' color='white'></box-icon>",duration:4e3,progress:"auto",color:"danger",position:"top-center",title:"Error",text:e})},successNotification(e){this.$vs.notification({icon:"<box-icon name='select-multiple' color='white'></box-icon>",color:"success",position:"top-center",duration:1800,title:"Success",text:e})}},watch:{folderDialog(e){e||(this.folderInputError=!1,this.folderInputErrorMsg="")},renameDialog(e){e||(this.renameInputError=!1,this.renameInputErrorMsg="")},uploadDialog(e){e||(this.loadData(),this.$store.dispatch("getUsedCapacity"))}}},q=A,V=(0,f.Z)(q,i,a,!1,null,"cde450e2",null),G=V.exports,X=o(530),H=o.n(X);n["default"].use(r.ZP);const K=[{path:"/",name:"home",component:G},{path:"/user",name:"user",component:()=>o.e(85).then(o.bind(o,5085))},{path:"/register",name:"register",component:()=>o.e(587).then(o.bind(o,1587))},{path:"/login",name:"login",component:()=>o.e(347).then(o.bind(o,4347))},{path:"/retrieve",name:"retrieve",component:()=>o.e(352).then(o.bind(o,4352))},{path:"/pwd",name:"password",component:()=>o.e(758).then(o.bind(o,1758))}],W=new r.ZP({routes:K});W.beforeEach(((e,t,o)=>{null!==t.name&&H().start();const n=e.name,r=W.app.$options.store.state.user.token;""!==r||"home"!==n&&"user"!==n&&"password"!==n?""===r||"login"!==n&&"register"!==n&&"retrieve"!==n?o():(o("/"),H().done()):(o("/login"),H().done())})),W.afterEach((()=>{H().done()}));var J=W},7232:function(e,t,o){"use strict";o.d(t,{Z:function(){return c}});var n=o(6369),r=o(3822),i=o(586),a={state:()=>({list:[],usedCapacity:0,dragFileId:"",dropFolderId:""}),mutations:{clearFileList(e){e.list=[]},setList(e,t){e.list=t},setUsedCapacity(e,t){e.usedCapacity=t},setDragFildId(e,t){e.dragFileId=t},setDropFolderId(e,t){e.dropFolderId=t}},actions:{async getList({commit:e}){const{data:t}=await(0,i.Vm)();e("setList",t)},async getUsedCapacity({commit:e}){const{data:{usedCapacity:t}}=await(0,i.xT)();e("setUsedCapacity",t)},async moveFile({state:e,commit:t}){await(0,i.G)(e.dragFileId,e.dropFolderId),t("setDragFildId",""),t("setDropFolderId","")}},getters:{capacityRatio(e,t){const o=(e.usedCapacity/t.capacity).toFixed(2);return(o>=1||o<0?1:o)||0}}},s=(o(7658),{state:()=>({list:[{lid:-1,name:"Home"}],prev:[]}),mutations:{changeLocation(e,t){e.prev=[...e.list],e.list=e.list.slice(0,t+1)},cancelChange(e){e.list=e.prev},setRootLid(e,t){e.list[0].lid=t},setLocation(e,t){e.prev=[...e.list],e.list.push(t)},backRoot(e){e.prev=[...e.list],e.list=[e.list[0]]}},actions:{backToPervPage({state:e,commit:t}){t("changeLocation",e.list.length-2)}},getters:{isRoot:e=>e.list.length<=1,currentLocation:e=>e.list[e.list.length-1],curLid:e=>e.list[e.list.length-1].lid}}),l={state:()=>({token:localStorage.getItem("USER_TOKEN")||"",info:null}),mutations:{setToken(e,t){e.token=t,localStorage.setItem("USER_TOKEN",t)},setInfo(e,t){e.info=t},clearInfo(e){e.token="",e.info=null,localStorage.removeItem("USER_TOKEN")}},actions:{async userLogin({commit:e},t){const o=await(0,i.bV)(t);e("backRoot"),e("setToken",o.data.token)},async userLogout({commit:e},t=!0){t&&await(0,i.wg)(),e("clearFileList"),e("clearInfo")},async getUserInfo({commit:e}){const{data:t}=await(0,i.dW)();e("setInfo",t)}},getters:{capacity(e){return e.info?.capacity||-1}}};n["default"].use(r.ZP);var c=new r.ZP.Store({modules:{file:a,location:s,user:l}})},1399:function(e,t,o){"use strict";o.d(t,{M:function(){return n}});const n=e=>{if(null==e)return"-";const t=1024,o=1048576,n=1073741824;return e<t?`${e} B`:e<o?`${(e/t).toFixed(2)} KB`:e<n?`${(e/o).toFixed(2)} MB`:`${(e/n).toFixed(2)} GB`}},4847:function(e,t,o){"use strict";o.d(t,{Gu:function(){return a},I2:function(){return d},Ie:function(){return c},Le:function(){return u},a5:function(){return l},qg:function(){return p}});var n=o(7499),r=o.n(n);const i=e=>void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length,a=(e,t,...o)=>{const{errors:n,isValid:r}=e(...o);return!!r||(Object.keys(n).forEach((e=>{t[e+"Error"]=!0,t[e+"ErrorMsg"]=n[e]})),!1)},s=e=>{let t={};return e=i(e)?"":e,r().isEmpty(e)&&(t.password="Password can not be empty"),r().isLength(e,{min:6,max:16})||(t.password="Password length must be between 6-16"),{errors:t,isValid:i(t)}},l=(e,t)=>{let o=Object.assign({},s(t).errors);return e=i(e)?"":e,r().isEmpty(e)&&(o.username="Username can not be empty"),r().isLength(e,{min:6,max:16})||(o.username="Username length must be between 6-16"),{errors:o,isValid:i(o)}},c=e=>{let t=Object.assign({},l(e.username,e.password).errors);return e.password2=i(e.password2)?"":e.password2,e.uname=i(e.uname)?"":e.uname,e.email=i(e.email)?"":e.email,r().isEmpty(e.password2)&&(t.password2="Confirm password can not be empty"),r().equals(e.password,e.password2)||(t.password2="The two passwords do not match"),r().isEmpty(e.uname)&&(t.uname="Uname can not be empty"),r().isLength(e.uname,{min:1,max:20})||(t.uname="Nickname length must be between 1-20"),r().isEmpty(e.email)&&(t.email="Email can not be empty"),r().isEmail(e.email)||(t.email="Invalid email address"),{errors:t,isValid:i(t)}},d=(e,t)=>{let o={};return e=i(e)?"":e,t=i(t)?"":t,r().isEmpty(e)&&(o.oldPwd="Old password can not be empty"),r().isEmpty(t)&&(o.newPwd="New password can not be empty"),r().isLength(t,{min:6,max:16})||(o.newPwd="New password length must be between 6-16"),{errors:o,isValid:i(o)}},u=e=>{let t={};return e=i(e)?"":e,r().isEmpty(e)&&(t.email="Email can not be empty"),r().isEmail(e)||(t.email="Invalid email address"),{errors:t,isValid:i(t)}},p=(e,t="name")=>{let o={};return e=i(e)?"":e,r().isEmpty(e)&&(o[t]="Name can not be empty"),r().isLength(e,{min:1,max:20})||(o[t]="Name length must be between 1-20"),{errors:o,isValid:i(o)}}}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,i){if(!n){var a=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],i=e[d][2];for(var s=!0,l=0;l<n.length;l++)(!1&i||a>=i)&&Object.keys(o.O).every((function(e){return o.O[e](n[l])}))?n.splice(l--,1):(s=!1,i<a&&(a=i));if(s){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,r,i]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/"+e+"."+{85:"700006c0",347:"917a905d",352:"572e6bcb",587:"f4d73eed",758:"61369c04"}[e]+".js"}}(),function(){o.miniCssF=function(e){return"css/"+e+"."+{85:"05e7232f",347:"e7f36f01",352:"74b3d939",587:"fd249cea",758:"d584d37c"}[e]+".css"}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="vendisc-front:";o.l=function(n,r,i,a){if(e[n])e[n].push(r);else{var s,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){s=u;break}}s||(l=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",t+i),s.src=n),e[n]=[r];var p=function(t,o){s.onerror=s.onload=null,clearTimeout(f);var r=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((function(e){return e(o)})),t)return t(o)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/views/"}(),function(){var e=function(e,t,o,n){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css";var i=function(i){if(r.onerror=r.onload=null,"load"===i.type)o();else{var a=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=s,r.parentNode.removeChild(r),n(l)}};return r.onerror=r.onload=i,r.href=t,document.head.appendChild(r),r},t=function(e,t){for(var o=document.getElementsByTagName("link"),n=0;n<o.length;n++){var r=o[n],i=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(i===e||i===t))return r}var a=document.getElementsByTagName("style");for(n=0;n<a.length;n++){r=a[n],i=r.getAttribute("data-href");if(i===e||i===t)return r}},n=function(n){return new Promise((function(r,i){var a=o.miniCssF(n),s=o.p+a;if(t(a,s))return r();e(n,s,r,i)}))},r={143:0};o.f.miniCss=function(e,t){var o={85:1,347:1,352:1,587:1,758:1};r[e]?t.push(r[e]):0!==r[e]&&o[e]&&t.push(r[e]=n(e).then((function(){r[e]=0}),(function(t){throw delete r[e],t})))}}(),function(){var e={143:0};o.f.j=function(t,n){var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise((function(o,n){r=e[t]=[o,n]}));n.push(r[2]=i);var a=o.p+o.u(t),s=new Error,l=function(n){if(o.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,r[1](s)}};o.l(a,l,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,i,a=n[0],s=n[1],l=n[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(l)var d=l(o)}for(t&&t(n);c<a.length;c++)i=a[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(d)},n=self["webpackChunkvendisc_front"]=self["webpackChunkvendisc_front"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(5518)}));n=o.O(n)})();
//# sourceMappingURL=app.f7c4feef.js.map